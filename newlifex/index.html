<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>聊聊如何设计千万级吞吐量的.Net Core网络通信！ | xxred&#39;s notes</title>
    <meta name="description" content="记录学习过程，收集学习资源">
    <link rel="icon" href="/logo.png">
  <link rel="manifest" href="/manifest.json">
  <meta name="theme-color" content="#3ab1ff">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  <link rel="apple-touch-icon" href="/logo.jpg">
  <meta name="msapplication-TileImage" content="/logo.jpg">
  <meta name="msapplication-TileColor" content="#000000">
    
    <link rel="preload" href="/assets/css/0.styles.b730d4bd.css" as="style"><link rel="preload" href="/assets/js/app.64656314.js" as="script"><link rel="preload" href="/assets/js/67.5512e56f.js" as="script"><link rel="prefetch" href="/assets/js/10.9854e2d9.js"><link rel="prefetch" href="/assets/js/100.501533cf.js"><link rel="prefetch" href="/assets/js/11.90b4f6c6.js"><link rel="prefetch" href="/assets/js/12.c474a85d.js"><link rel="prefetch" href="/assets/js/13.dda8a0cb.js"><link rel="prefetch" href="/assets/js/14.0e08ece7.js"><link rel="prefetch" href="/assets/js/15.44d1400a.js"><link rel="prefetch" href="/assets/js/16.ad1ccfc8.js"><link rel="prefetch" href="/assets/js/17.65379de5.js"><link rel="prefetch" href="/assets/js/18.22c84bf3.js"><link rel="prefetch" href="/assets/js/19.a5d9f464.js"><link rel="prefetch" href="/assets/js/2.25d537b3.js"><link rel="prefetch" href="/assets/js/20.428e01ba.js"><link rel="prefetch" href="/assets/js/21.dc5046e0.js"><link rel="prefetch" href="/assets/js/22.925a7dc8.js"><link rel="prefetch" href="/assets/js/23.ac552031.js"><link rel="prefetch" href="/assets/js/24.f0a57b51.js"><link rel="prefetch" href="/assets/js/25.6a04b420.js"><link rel="prefetch" href="/assets/js/26.6dc39abd.js"><link rel="prefetch" href="/assets/js/27.4bfdc57c.js"><link rel="prefetch" href="/assets/js/28.7fed2211.js"><link rel="prefetch" href="/assets/js/29.94f5979e.js"><link rel="prefetch" href="/assets/js/3.c0ceed84.js"><link rel="prefetch" href="/assets/js/30.42459e5f.js"><link rel="prefetch" href="/assets/js/31.1980220b.js"><link rel="prefetch" href="/assets/js/32.1e560b41.js"><link rel="prefetch" href="/assets/js/33.ca278e33.js"><link rel="prefetch" href="/assets/js/34.133334b3.js"><link rel="prefetch" href="/assets/js/35.3bd1b645.js"><link rel="prefetch" href="/assets/js/36.5ba987f0.js"><link rel="prefetch" href="/assets/js/37.6165bc38.js"><link rel="prefetch" href="/assets/js/38.b1c50274.js"><link rel="prefetch" href="/assets/js/39.470d199a.js"><link rel="prefetch" href="/assets/js/4.5f1d9e9b.js"><link rel="prefetch" href="/assets/js/40.c3ecb0b1.js"><link rel="prefetch" href="/assets/js/41.a072bffe.js"><link rel="prefetch" href="/assets/js/42.a7f0784a.js"><link rel="prefetch" href="/assets/js/43.43229cc1.js"><link rel="prefetch" href="/assets/js/44.baa4102d.js"><link rel="prefetch" href="/assets/js/45.2fe93a52.js"><link rel="prefetch" href="/assets/js/46.354d74a4.js"><link rel="prefetch" href="/assets/js/47.1d345d6f.js"><link rel="prefetch" href="/assets/js/48.4d0d3ea0.js"><link rel="prefetch" href="/assets/js/49.61c2d1cb.js"><link rel="prefetch" href="/assets/js/5.99a72ccb.js"><link rel="prefetch" href="/assets/js/50.fcc54f26.js"><link rel="prefetch" href="/assets/js/51.be50e864.js"><link rel="prefetch" href="/assets/js/52.6595b5d3.js"><link rel="prefetch" href="/assets/js/53.23cc0c03.js"><link rel="prefetch" href="/assets/js/54.c01b974b.js"><link rel="prefetch" href="/assets/js/55.ebd3a49b.js"><link rel="prefetch" href="/assets/js/56.f27b70e3.js"><link rel="prefetch" href="/assets/js/57.fec32608.js"><link rel="prefetch" href="/assets/js/58.0e3d9506.js"><link rel="prefetch" href="/assets/js/59.672dfeed.js"><link rel="prefetch" href="/assets/js/6.e68ec728.js"><link rel="prefetch" href="/assets/js/60.174361db.js"><link rel="prefetch" href="/assets/js/61.5c3b9c2b.js"><link rel="prefetch" href="/assets/js/62.5c71f8a0.js"><link rel="prefetch" href="/assets/js/63.69e16fa9.js"><link rel="prefetch" href="/assets/js/64.409caf0b.js"><link rel="prefetch" href="/assets/js/65.a9077c92.js"><link rel="prefetch" href="/assets/js/66.0b19e7e4.js"><link rel="prefetch" href="/assets/js/68.cef5b470.js"><link rel="prefetch" href="/assets/js/69.4d7388a7.js"><link rel="prefetch" href="/assets/js/7.88bfd9af.js"><link rel="prefetch" href="/assets/js/70.21175cd8.js"><link rel="prefetch" href="/assets/js/71.507daeb7.js"><link rel="prefetch" href="/assets/js/72.81e98174.js"><link rel="prefetch" href="/assets/js/73.439fbd60.js"><link rel="prefetch" href="/assets/js/74.c14105da.js"><link rel="prefetch" href="/assets/js/75.90c52143.js"><link rel="prefetch" href="/assets/js/76.d7153610.js"><link rel="prefetch" href="/assets/js/77.a6880afe.js"><link rel="prefetch" href="/assets/js/78.18047845.js"><link rel="prefetch" href="/assets/js/79.c162ff99.js"><link rel="prefetch" href="/assets/js/8.03d12a0f.js"><link rel="prefetch" href="/assets/js/80.525c3edd.js"><link rel="prefetch" href="/assets/js/81.ad71dbb2.js"><link rel="prefetch" href="/assets/js/82.0b2fe4b5.js"><link rel="prefetch" href="/assets/js/83.df60f012.js"><link rel="prefetch" href="/assets/js/84.34fffd39.js"><link rel="prefetch" href="/assets/js/85.30188b42.js"><link rel="prefetch" href="/assets/js/86.9d634fb8.js"><link rel="prefetch" href="/assets/js/87.cb0d8df0.js"><link rel="prefetch" href="/assets/js/88.31670bbc.js"><link rel="prefetch" href="/assets/js/89.dc5012e7.js"><link rel="prefetch" href="/assets/js/9.d5032bc7.js"><link rel="prefetch" href="/assets/js/90.39ff2bd8.js"><link rel="prefetch" href="/assets/js/91.51c74f03.js"><link rel="prefetch" href="/assets/js/92.365d27a4.js"><link rel="prefetch" href="/assets/js/93.dcbe2b65.js"><link rel="prefetch" href="/assets/js/94.4c39c722.js"><link rel="prefetch" href="/assets/js/95.7514ec95.js"><link rel="prefetch" href="/assets/js/96.f838fce0.js"><link rel="prefetch" href="/assets/js/97.ccac75c1.js"><link rel="prefetch" href="/assets/js/98.8c22743e.js"><link rel="prefetch" href="/assets/js/99.5c29f22f.js">
    <link rel="stylesheet" href="/assets/css/0.styles.b730d4bd.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><!----> <span class="site-name">xxred's notes</span></a> <div class="links" style="max-width:nullpx;"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">.Net Core</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dotnet-core/dotnetcore/" class="nav-link">.Net Core</a></li><li class="dropdown-item"><!----> <a href="/dotnet-core/aspnetcore/" class="nav-link">Asp.Net Core</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front-end/nodejs/" class="nav-link">nodejs</a></li><li class="dropdown-item"><!----> <a href="/front-end/vuejs/" class="nav-link">vuejs</a></li><li class="dropdown-item"><!----> <a href="/front-end/iview/" class="nav-link">iview</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">编程语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/programing-language/csharp/" class="nav-link">C#</a></li><li class="dropdown-item"><!----> <a href="/programing-language/powershell/" class="nav-link">PowerShell</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">编程基础</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/character-coding/" class="nav-link">字符编码</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">操作系统</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/operating-system/windows/" class="nav-link">Windows</a></li><li class="dropdown-item"><!----> <a href="/operating-system/linux/" class="nav-link">Linux</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>开发工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dev-tool/visualstudio/" class="nav-link">Visual Studio</a></li><li class="dropdown-subitem"><a href="/dev-tool/visualstudio-code/" class="nav-link">Visual Studio Code</a></li></ul></li><li class="dropdown-item"><h4>文档工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/tools/doc/docfx/" class="nav-link">DocFX</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/awesome-collection/" class="nav-link">资源收集</a></div> <a href="https://github.com/xxred/xxred.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar"><nav class="nav-links"><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">.Net Core</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/dotnet-core/dotnetcore/" class="nav-link">.Net Core</a></li><li class="dropdown-item"><!----> <a href="/dotnet-core/aspnetcore/" class="nav-link">Asp.Net Core</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">前端</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/front-end/nodejs/" class="nav-link">nodejs</a></li><li class="dropdown-item"><!----> <a href="/front-end/vuejs/" class="nav-link">vuejs</a></li><li class="dropdown-item"><!----> <a href="/front-end/iview/" class="nav-link">iview</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">编程语言</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/programing-language/csharp/" class="nav-link">C#</a></li><li class="dropdown-item"><!----> <a href="/programing-language/powershell/" class="nav-link">PowerShell</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">编程基础</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/character-coding/" class="nav-link">字符编码</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">操作系统</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/operating-system/windows/" class="nav-link">Windows</a></li><li class="dropdown-item"><!----> <a href="/operating-system/linux/" class="nav-link">Linux</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><a class="dropdown-title"><span class="title">工具</span> <span class="arrow right"></span></a> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>开发工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/dev-tool/visualstudio/" class="nav-link">Visual Studio</a></li><li class="dropdown-subitem"><a href="/dev-tool/visualstudio-code/" class="nav-link">Visual Studio Code</a></li></ul></li><li class="dropdown-item"><h4>文档工具</h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/tools/doc/docfx/" class="nav-link">DocFX</a></li></ul></li></ul></div></div><div class="nav-item"><a href="/awesome-collection/" class="nav-link">资源收集</a></div> <a href="https://github.com/xxred/xxred.github.io" target="_blank" rel="noopener noreferrer" class="repo-link">
    查看源码
    <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></nav>  <ul class="sidebar-links"><li><div class="sidebar-group first collapsable"><p class="sidebar-heading open"><span>newlifex</span> <span class="arrow down"></span></p> <ul class="sidebar-group-items"><li><a href="/newlifex/" class="active sidebar-link">聊聊如何设计千万级吞吐量的.Net Core网络通信！</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/newlifex/#介绍" class="sidebar-link">介绍</a></li><li class="sidebar-sub-header"><a href="/newlifex/#_1-1-开始网络编程" class="sidebar-link">1.1 开始网络编程</a></li><li class="sidebar-sub-header"><a href="/newlifex/#_1-2-构建可靠网络服务" class="sidebar-link">1.2 构建可靠网络服务</a></li><li class="sidebar-sub-header"><a href="/newlifex/#_1-3-压测" class="sidebar-link">1.3 压测</a></li><li class="sidebar-sub-header"><a href="/newlifex/#网络编程的坑" class="sidebar-link">网络编程的坑</a></li><li class="sidebar-sub-header"><a href="/newlifex/#_1-4-网络编程的坎——粘包" class="sidebar-link">1.4  网络编程的坎——粘包</a></li><li class="sidebar-sub-header"><a href="/newlifex/#_1-5-netcore版rpc框架" class="sidebar-link">1.5 .NetCore版RPC框架</a></li><li class="sidebar-sub-header"><a href="/newlifex/#_2-1-人人都有一个自己的高性能网络库" class="sidebar-link">2.1 人人都有一个自己的高性能网络库</a></li><li class="sidebar-sub-header"><a href="/newlifex/#_2-2-高性能设计要点" class="sidebar-link">2.2 高性能设计要点</a></li><li class="sidebar-sub-header"><a href="/newlifex/#最后" class="sidebar-link">最后</a></li></ul></li><li><a href="/newlifex/Redis100亿小数据.html" class="sidebar-link">Redis封装及使用技巧直播</a></li></ul></div></li></ul> </div> <div class="page"> <div class="content"><h1 id="聊聊如何设计千万级吞吐量的-net-core网络通信！"><a href="#聊聊如何设计千万级吞吐量的-net-core网络通信！" aria-hidden="true" class="header-anchor">#</a> 聊聊如何设计千万级吞吐量的.Net Core网络通信！</h1> <ul><li>作者：<a href="https://www.cnblogs.com/nnhy/" target="_blank" rel="noopener noreferrer">大石头<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>时间：2018-10-26 晚上 20:00</li> <li>地点：QQ群-1600800</li> <li>内容：网络通信，
<ol><li>网络库使用方式</li> <li>网络库设计理念，高性能要点</li></ol></li></ul> <h2 id="介绍"><a href="#介绍" aria-hidden="true" class="header-anchor">#</a> 介绍</h2> <ul><li><p>首先看下面这张很具有代表性的图，2018年5月份做的测试。当时单服务器得到 <code>2256tps</code>(Transactions Per Second,每秒事务数) 的吞吐率。这次测试只是说明一个问题，.Net可以做超高吞吐率的应用。
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181026235733867-1754140784.png" alt> <img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181026235909539-1578163921.png" alt></p></li> <li><p>当时测试相关记录和代码地址</p> <ul><li>记录：https://www.cnblogs.com/nnhy/p/newlife_net_benchmark.html</li> <li>代码国外地址：https://github.com/nnhy/NewLife.Net.Tests</li> <li>代码国内地址：http://git.newlifex.com/Stone/NewLife.Net.Tests</li></ul></li></ul> <h2 id="_1-1-开始网络编程"><a href="#_1-1-开始网络编程" aria-hidden="true" class="header-anchor">#</a> 1.1 开始网络编程</h2> <h3 id="简单的网络程序示例"><a href="#简单的网络程序示例" aria-hidden="true" class="header-anchor">#</a> 简单的网络程序示例</h3> <ul><li>相关使用介绍：https://www.cnblogs.com/nnhy/p/newlife_net_echo.html</li> <li>克隆上面的代码，运行<code>EchoTest</code>项目，打开编译的exe，打开两次，一个选1作为服务器，一个选2作为客户端
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027002148820-2146341896.png" alt> <img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027001609291-1374054519.png" alt></li> <li>在客户端连接服务器和给服务端发送数据的时候，分别触发<code>Start</code>和<code>OnReceive</code>方法，连接之后服务端发送了Welcome 的消息，客户端发送5次“你好”。服务端回传收到的数据，打了一个日志，把收到的信息转成字符串输出到控制台。</li> <li>NetServer是应用级网络服务器，支持tcp/udp/ipv4/ipv6。上面可以看到，同时监听了四个端口。</li> <li><a href="https://github.com/NewLifeX/XCoder" target="_blank" rel="noopener noreferrer">码神工具<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>也可以连接上来
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027003502567-1186544414.png" alt></li></ul> <h3 id="解释"><a href="#解释" aria-hidden="true" class="header-anchor">#</a> 解释</h3> <ul><li>对于网络会话来说，最关键的就是客户端连上来，以及收到数据包，这两部分，对应上面<code>Start</code>和<code>OnReceive</code>两个方法
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027004204160-2079112329.png" alt> <img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027004211636-1775245956.png" alt></li></ul> <h4 id="服务端"><a href="#服务端" aria-hidden="true" class="header-anchor">#</a> 服务端</h4> <ul><li>上面是最小的网络库例程，简单演示了服务端和客户端，连接和收发信息。网络应用分为NetServer/NetSession，服务端、会话，N个客户端连接服务器，就会有N个会话。来一个客户端连接，服务端就new一个新的NetSession，并执行Start，收到一个数据包，就执行OnReceive，连接断开，就执行OnDispose，这便是服务端的全部。</li> <li>客户端连接刚上来的时候，没有数据包等其它信息，所以这个时候没有参数。客户端发数据包过来，<code>OnReceive</code>函数在处理。</li> <li>服务端的创建，可以是很简单，看以下截图。这里为了测试方便，开了很多Log，实际使用的时候，根据需要注释。
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027005200798-1579528699.png" alt></li> <li>长连接、心跳第二节设计理念再讲。</li></ul> <h4 id="客户端"><a href="#客户端" aria-hidden="true" class="header-anchor">#</a> 客户端</h4> <ul><li>跟很多网络库不同，NewLife.Net除了服务端，还封装了客户端。客户端的核心，也就是Send函数和Received事件，<strong>同步发送，异步接收。</strong> <img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027005818755-893878361.png" alt></li> <li>因为是长连接，所以服务端随时可以向客户端发送数据包，客户端也可以收到。tcp在不做设置的时候，默认长连接2小时。</li> <li>NetServer默认20分钟，在没有心跳的时候，20分钟没有数据包往来，服务端会干掉这个会话。</li> <li>虽然上面讲的NetServer和Client，都是tcp，但是换成其它协议也是可以的。这里的NetServer和NetUri.CreateRemote，同时支持Tcp/Udp/IPv4/IPv6等，CreateRemote内部，就是根据地址的不同，去new不同的客户端。所以我们写的代码，根本不在意用的是tcp还是udp，或者IPv6。有兴趣的可以看看<a href="https://github.com/NewLifeX/X/blob/master/NewLife.Core/Net/NetHelper.cs#L690" target="_blank" rel="noopener noreferrer">源码<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li></ul> <h2 id="_1-2-构建可靠网络服务"><a href="#_1-2-构建可靠网络服务" aria-hidden="true" class="header-anchor">#</a> 1.2 构建可靠网络服务</h2> <ul><li><a href="https://www.cnblogs.com/nnhy/p/newlife_net_agent.html" target="_blank" rel="noopener noreferrer">相关博客<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>要真正形成一个网络服务，那得稳定可靠。上面例程EchoTest只是简单演示，接下来看下一个例程EchoAgent。
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027011612919-738776179.png" alt> <img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027011636747-278701050.png" alt> <img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027011653992-732330205.png" alt></li></ul> <h3 id="安装运行"><a href="#安装运行" aria-hidden="true" class="header-anchor">#</a> 安装运行</h3> <ul><li>这是一个标准的Windows服务，有了这个东西，我们就可以妥妥的注册到Windows里面去。这也是目前我们大量数据分析程序的必备。</li> <li>首先运行EchoAgent，按2，安装注册服务，用管理员身份运行。安装成功然后可以在服务里面找到刚刚安装的服务。
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027011738924-103714494.png" alt> <img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027011905411-1360917063.png" alt> <img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027011925902-1428458419.png" alt> <img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027011944405-1268711412.png" alt></li> <li>安装完成可以在服务上找到，再次按2就是卸载，这个是<a href="https://github.com/NewLifeX/XAgent" target="_blank" rel="noopener noreferrer">XAgent<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>提供的功能
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027012009457-2019839893.png" alt> <img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027012036765-698037494.png" alt></li> <li>这时候按3，启动服务
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027012255110-866863531.png" alt></li></ul> <h3 id="代码解释"><a href="#代码解释" aria-hidden="true" class="header-anchor">#</a> 代码解释</h3> <ul><li>接下来看代码，服务启动的时候，执行StartWork。在这个时候实例化并启动NetServer，得到的效果就跟例程<code>EchoTest</code>一样，区别是一个是控制台一个是服务。停止服务时执行StopWork，我们可以在这里关闭NetServer。详细请看<a href="http://git.newlifex.com/NewLife/NewLife.Net/Blob/master/EchoAgent/Program.cs" target="_blank" rel="noopener noreferrer">源码<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a> <img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027012650150-767564618.png" alt></li> <li>必须有这个东西，你的网络服务程序，才有可能达到产品级。linux上直接控制台，上nohup，当然还有很多其它办法。以后希望这个XAgent能够支持linux吧，这样就一劳永逸了</li></ul> <h2 id="_1-3-压测"><a href="#_1-3-压测" aria-hidden="true" class="header-anchor">#</a> 1.3 压测</h2> <ul><li><a href="https://www.cnblogs.com/nnhy/p/newlife_net_benchmark.html" target="_blank" rel="noopener noreferrer">相关博客<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a></li> <li>只需要记住一个两个数字，.net应用打出来2266万tps，流量峰值4.5Gbps</li> <li>两千万吞吐量的数字，当然，只能看不能用。因为服务端只是刚才的Echo而已，并没有带什么业务。实际工作中，带着业务和数据库，能跑到10万已经非常非常牛逼了。</li> <li>我们工作中的服务可以跑到100万，但是我不敢，怕它不小心就崩了。所以我们都是按照10万的上限来设计，不够就堆服务器好了，达到5万以上后，稳定性更重要</li></ul> <h2 id="网络编程的坑"><a href="#网络编程的坑" aria-hidden="true" class="header-anchor">#</a> 网络编程的坑</h2> <ul><li>主要有粘包</li> <li>程序员中会网络编程的少，会解决粘包的更少！</li></ul> <h2 id="_1-4-网络编程的坎——粘包"><a href="#_1-4-网络编程的坎——粘包" aria-hidden="true" class="header-anchor">#</a> 1.4  网络编程的坎——粘包</h2> <ul><li>普遍情况，上万的程序员，会写网络程序的不到20%，会解决粘包问题的不到1%，如果大家会写网络程序，并且能解决粘包，那么至少已经达到了网络编程的中级水平。</li></ul> <h3 id="什么是粘包"><a href="#什么是粘包" aria-hidden="true" class="header-anchor">#</a> 什么是粘包</h3> <ul><li>举个栗子：客户端连续发了5个包，服务端就收到了一个大包。代码就不演示了，把第一个例程的这个睡眠去掉。
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027013515866-248752418.png" alt> <img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027013527707-1703518104.png" alt></li> <li>客户端连续发了5个包，服务端就收到了一个大包。</li></ul> <h3 id="原因"><a href="#原因" aria-hidden="true" class="header-anchor">#</a> 原因</h3> <ul><li>很多人可能都听说Tcp是流式协议，但是很少人去问，什么叫流式吧？流式，就是它把数据像管道一样传输过去。</li> <li>刚才我们发了5个 “你好”，它负责把这10个字发到对方，至于发多少次，每次发几个字，不用我们操心，tcp底层自己处理。tcp负责把数据一个不丢的按顺序的发过去。所以，为了性能，它一般会把相近的数据包凑到一起发过去。对方收到一个大包，5个小包都粘在了一起，这就是最简单的粘包。</li> <li>这个特性由NoDelay设置决定。NoDelay默认是false，需要自己设置。如果设置了，就不会等待。但是不要想得那么美好，因为对方可能合包。</li> <li>局域网MTU(Maximum Transmission Unit，最大传输单元)是1500，处于ip tcp 头部等，大概1472多点的样子。</li></ul> <h3 id="更复杂的粘包及解决方法"><a href="#更复杂的粘包及解决方法" aria-hidden="true" class="header-anchor">#</a> 更复杂的粘包及解决方法</h3> <ul><li>A 1000 字节 B 也是 1000字节，对方可能收到两个包，1400 + 600。对方可能收到两个包，1400 + 600。</li> <li>凡是以特殊符号开头或结尾来处理粘包的办法，都会有这样那样的缺陷，最终是给自己挖坑。所以，tcp粘包，绝大部分解决方案，偏向于指定数据包长度。这其中大部分使用4字节长度，长度+数据。对方收到的时候，根据长度判断后面数据足够了没有。</li> <li>这是粘包的处理代码：http://git.newlifex.com/NewLife/X/Blob/master/NewLife.Core/Net/Handlers/MessageCodec.cs
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027014607168-577879264.png" alt></li> <li>每次判断长度，接收一个或多个包，如果接收不完，留下，存起来。等下一个包到来的时候，拼凑完整。</li> <li>虽然tcp确保数据不丢，但是难免我们自己失手，弄丢了一点点数据。为了避免祸害后面所有包，就需要进行特殊处理了。</li> <li>每个数据帧，自己把头部长度和数据体凑一起发送啊，tcp确保顺序。这里我们把超时时间设置为3~5秒，每次凑包，如果发现上次有残留，并且超时了，那么就扔了它，省得祸害后面。
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027014934043-1338449804.png" alt></li> <li>根据以上，粘包的关键解决办法，就是设定数据格式，可以看看我们的<a href="https://www.cnblogs.com/nnhy/p/srmp.html" target="_blank" rel="noopener noreferrer">SRMP协议<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，1字节标识，1字节序号，2字节长度
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027015258134-313626553.png" alt></li> <li>如果客户端发送太频繁，服务端tcp缓冲区阻塞，发送窗口会逐步缩小到0，不再接受客户端数据。</li></ul> <h2 id="_1-5-netcore版rpc框架"><a href="#_1-5-netcore版rpc框架" aria-hidden="true" class="header-anchor">#</a> 1.5 .NetCore版RPC框架</h2> <ul><li>NetCore版RPC框架<a href="https://www.cnblogs.com/nnhy/p/newlife_apiserver.html" target="_blank" rel="noopener noreferrer">NewLife.ApiServer<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>。
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027015925902-816951275.png" alt></li> <li>先看看这个效果
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027015900151-591504542.png" alt></li></ul> <h3 id="代码分析"><a href="#代码分析" aria-hidden="true" class="header-anchor">#</a> 代码分析</h3> <ul><li>我们看这部分代码，4次调用远程函数，成功获取结果，包括二进制高速调用、返回复杂对象、捕获远程异常，没错，这就是一个RPC。
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027020020172-1996432747.png" alt> <img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027020215851-1188284918.png" alt></li></ul> <h4 id="服务端-2"><a href="#服务端-2" aria-hidden="true" class="header-anchor">#</a> 服务端</h4> <ul><li>有没有发现，这个ApiServer跟前面的NetServer有点像？其实ApiServer内部就有一个NetServer
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027020254151-308928025.png" alt></li> <li>这么些行代码，就几个地方有价值，一个是注册了两个控制器。你可以直接理解为Mvc的控制器，只不过我们没有路由管理系统，直接手工注册。</li> <li>第二个是指定编码器为Json，用Json传输参数和返回值。其实内部默认就是Json，可以不用指定</li> <li>看看我们的控制器，特别像Mvc，只不过这里的Controller没有基类，各个Action返回值不是ActionResult，是的，ApiServer就是一个按照Mvc风格设置的RPC框架
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027020400338-831300481.png" alt></li> <li>返回复杂对象
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027020435974-1210144251.png" alt></li> <li>做请求预处理，甚至拦截异常
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027020506481-1237236197.png" alt></li> <li>像下面这样写RPC服务，然后把它注册到ApiServer上，客户端就可以在1234端口上请求这些接口服务啦
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027020557726-2096270337.png" alt> <img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027020610445-1123270905.png" alt></li></ul> <h4 id="客户端-2"><a href="#客户端-2" aria-hidden="true" class="header-anchor">#</a> 客户端</h4> <ul><li>客户端是ApiClient，这里的MyClient继承自ApiClient
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027020744510-1475570757.png" alt> <img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027020751604-513118689.png" alt></li> <li>这些就是我们刚才客户端远程调用的stub代码啦，当然，我们没有自动生成stub，也没有要求客户端跟服务端共用接口之类。实际上，我们认为完全没有必要做接口约束，大部分项目的服务接口很少，并且要求灵活多变</li> <li>stub就是类似于，刚才那个MyController实现IAbc接口，然后客户端根据服务端元数据自动在内存里面生成一个stub类并编译，这个类实现了IAbc接口。
客户端直接操作接口，还以为在调用服务端 的函数呢</li> <li>其实stub代码内部，就是封装了 这里的InvokeAsync这些代码，等同于自动生成这些代码，包括gRPC、Thrift等都是这么干的</li></ul> <h4 id="框架解析"><a href="#框架解析" aria-hidden="true" class="header-anchor">#</a> 框架解析</h4> <ul><li>这个RPC框架，封包协议就是刚才的<a href="https://www.cnblogs.com/nnhy/p/srmp.html" target="_blank" rel="noopener noreferrer">SRMP<svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></a>，负载数据也就是协议是json</li> <li>当需要高速传输的时候，参数用Byte[]，它就会直接传输，不经json序列化，这是多年经验得到的灵活性与性能的最佳结合点</li></ul> <h2 id="_2-1-人人都有一个自己的高性能网络库"><a href="#_2-1-人人都有一个自己的高性能网络库" aria-hidden="true" class="header-anchor">#</a> 2.1 人人都有一个自己的高性能网络库</h2> <ul><li>网络库核心代码：http://git.newlifex.com/NewLife/X/Tree/master/NewLife.Core/Net</li> <li>我们一开始就是让Tcp/Udp可以混合使用，网络库设计于2005年，应该要比现如今绝大部分网络框架要老。服务端清一色采用 Server+Session 的方式。</li> <li>网络库的几个精髓文件
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027021743823-606212944.png" alt></li> <li>其中比较重要的一个，里面实现了 Open/Close/Send/Receive 系列封装，Tcp/Udp略有不同，重载就好了。打开关闭比较简单，就不讲了
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027021924221-1935855185.png" alt></li> <li>所有对象，不管客户端服务端，都实现ISocket。然后客户端Client，服务端Server+Session。tcp+udp同时支持并不难，因为它们都基于Socket。</li> <li>目前无状态无会话的通信架构，做不到高性能。我们就是依靠<strong>长连接</strong>以及<strong>合并小包</strong>，实现超高吞吐量</li> <li>一般灵活性和高性能都是互相矛盾的</li></ul> <h2 id="_2-2-高性能设计要点"><a href="#_2-2-高性能设计要点" aria-hidden="true" class="header-anchor">#</a> 2.2 高性能设计要点</h2> <ul><li>第一要点：<strong>同步发送</strong>，因为要做发送队列、拆分、合并，等等，异步发送大大增加了复杂度。大家如果将来遇到诡异的40ms延迟，非常可能就是tcp的nodelay作怪，可以设为true解决</li> <li>第二要点：<strong>IOCP</strong>，高吞吐率的服务端，一定是异步接收，而不是多线程同步。当然，可以指定若干个线程去select，也就是Linux里面常见的poll，那个不在这里讨论，Windows极少人这么干，大量资料表明，iocp更厉害。
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027022817636-1204939346.png" alt> <img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027023013231-973376447.png" alt> <ul><li>SAEA是.net/.netcore当下最流行的网络架构，我们可以通俗理解为，把这个缓冲区送给操作系统内核，待会有数据到来的时候，直接放在里面，这样子就减少了一次内核态到用户态的拷贝过程。</li> <li>我们测试4.5Gbps，除以8，大概是 540M字节，这个拷贝成本极高</li></ul></li> <li>第三要点：<strong>零拷贝ZeroCopy</strong>，这也是netty的核心优势。iocp是为了减少内核态到用户态的拷贝，zerocopy进一步把这个数据交给用户层，不用拷贝了。
<ul><li>数据处理，我们采用了链式管道，
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027023723251-931494927.png" alt></li> <li>这些都是管道的编码器
<img src="https://img2018.cnblogs.com/blog/1057748/201810/1057748-20181027023800151-952885401.png" alt></li></ul></li> <li>第四要点：<strong>合并小包</strong>，NoDelay=false，允许tcp合并小包，MTU=1500，除了头部，一般是1472</li> <li>第五要点：<strong>二进制序列化</strong>，消息报文尽可能短小，每个包1k，对于100Mbps，也就12M，理论上最多12000包，所以大量Json协议或者字符串协议，吞吐量都在1万上下
<ul><li>SRMP头部4字节，ApiServer的消息报文，一般二三十个字节，甚至十几个字节</li></ul></li> <li>第五要点：<strong>批量操作</strong>，<code>User FindByID(int id); User[] FindByIDs(int[] ids);</code></li></ul> <h2 id="最后"><a href="#最后" aria-hidden="true" class="header-anchor">#</a> 最后</h2> <ul><li>整理不全，大家凑合着看。中途录屏，语音啥的还掉了，准备得不是很好，下周再来一次吧，选Redis</li></ul></div> <div class="page-edit"><div class="edit-link"><a href="https://github.com/xxred/xxred.github.io/edit/master/docs/newlifex/README.md" target="_blank" rel="noopener noreferrer">帮助我们改善此页面！</a> <svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg></div> <div class="last-updated"><span class="prefix">上次更新: </span> <span class="time">10/30/2018, 12:23:58 PM</span></div></div> <div class="page-nav"><p class="inner"><!----> <span class="next"><a href="/newlifex/Redis100亿小数据.html">
          Redis封装及使用技巧直播
        </a>
        →
      </span></p></div> </div> <!----></div></div>
    <script src="/assets/js/app.64656314.js" defer></script><script src="/assets/js/67.5512e56f.js" defer></script>
  </body>
</html>
